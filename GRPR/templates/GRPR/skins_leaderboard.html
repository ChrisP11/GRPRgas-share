{% extends 'base.html' %}

{% block title %}Skins Leaderboard{% endblock %}

{% block content %}
<div class="container my-4">
    
    {% if gas_matches %}
    <h2 class="mt-4">Gas Tank</h2>

    {% if gas_totals %}
    <div class="text-center mt-3">
    <h4>
        <span class="badge bg-primary fs-5">PGA {{ gas_totals.pga }}</span>
        <span class="mx-2">â€“</span>
        <span class="badge bg-success fs-5">LIV {{ gas_totals.liv }}</span>
    </h4>
    </div>
    {% endif %}

    {% if gas_rosters %}
    <div class="mt-3">
    <a class="btn btn-outline-secondary btn-sm" data-bs-toggle="collapse" href="#rosterCollapse" role="button" aria-expanded="false" aria-controls="rosterCollapse">
        Show Roster
    </a>
    </div>

    <div class="collapse mt-2" id="rosterCollapse">
    <table class="table table-sm table-bordered text-center">
        <thead>
        <tr>
            <th>Time</th>
            <th>PGA</th>
            <th>LIV</th>
        </tr>
        </thead>
        <tbody>
        {% for r in gas_rosters %}
        <tr>
            <td>{{ r.label }}</td>
            <td>{{ r.pga }}</td>
            <td>{{ r.liv }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>
    {% endif %}

    <table class="table table-sm table-bordered text-center align-middle mb-4">
        <thead class="table-light">
        <tr>
            <th>Match</th>
            <th>Front</th>
            <th>Back</th>
            <th>Overall</th>
            <th>Thru</th>
            <th>Total Pts</th>
        </tr>
        </thead>
        <tbody>
        {% for m in gas_matches %}
        <tr>
            <td>{{ m.label }}</td>
            <td>{{ m.front }}</td>
            <td>{{ m.back }}</td>
            <td>{{ m.overall }}</td>
            <td>{{ m.thru }}</td>
            <td>{{ m.total }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}
    <br>
    <br>

    {% if forty_game_id is not None %}
    <h2>Forty Leaderboard - {{ play_date }} </h2>
    <table class="table table-bordered mb-4">
        <thead>
            <tr>
                <th>Group</th>
                <th>+/- Par</th>
                <th>Used</th>
                <th>Req</th>
                <th>Avail</th>
            </tr>
        </thead>
        <tbody>
            {% for row in forty_leaderboard %}
            <tr>
                <td>{{ row.group_id }}</td>
                <td>
                    {% if row.over_under > 0 %}+{% endif %}{{ row.over_under }}
                </td>
                <td>{{ row.scores_used }}</td>
                <td>{{ row.scores_needed }}</td>
                <td>{{ row.scores_available }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>
<br>

<div class="container my-4">
    <h2>Skins Leaderboard - {{ play_date }} {% if payout %} - ${{ payout }}/skin {% endif %}</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Player</th>
                <th>HDP</th>
                <th>Strokes</th>
                <th>Loc</th>
                <th>Skins</th>
                <th>Won</th>
            </tr>
        </thead>
        <tbody>
            {% for player in leaderboard %}
            <tr>
                <td>{{ player.last_name }}</td>
                <td>{{ player.raw_hdcp }}</td>
                <td>{{ player.net_hdcp }}</td>
                <td>{% if player.current_hole != 0 %}{{ player.current_hole }}{% endif %}</td>
                <td>{% if player.skins != 0 %}{{ player.skins }}{% endif %}</td>
                <td>{% if player.won_holes %}{{ player.won_holes|join:", " }}{% endif %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Group Buttons -->
<div class="d-flex justify-content-between mb-3">
    <div>
        {% if game_status == 'Live' %}
            {% for button in group_buttons %}
            <a href="{% url 'scorecard_view' %}?game_id={{ game_id }}&group_id={{ button.group_id }}" class="btn btn-primary">
                {{ button.label }}
            </a>
            {% endfor %}
        {% endif %}
    </div>
    <div>
        {% if game_status == 'Live' and scorecard_complete %}
        <a href="{% url 'skins_close_view' %}?game_id={{ game_id }}" class="btn btn-danger float-end me-2">Close Game</a>
        {% endif %}
        <a href="{% url 'scorecard_view' %}?game_id={{ game_id }}" class="btn btn-secondary-custom float-end">Big Scorecard</a>
        {% if game_status == 'Closed' and play_date == fake_date %}
        <a href="{% url 'skins_reopen_game_view' %}?game_id={{ game_id }}" class="btn btn-warning float-end me-2">Re-Open Game</a>
        {% endif %}
    </div>
</div>

{% endblock %}